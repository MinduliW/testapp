function [deltaJ2,deltaJ2_deltax] = J2acceleration(x, params)

% p = x(1); f = x(2);g = x(3); 
h = x(4); k = x(5); L = x(6);


% Get r 
r = CoordConv.ep2pv(x,params.mu);
r = norm(r(1:3));


% Define J2.
J2 = 1.08262668e-3; 

deltaJ2(1) = -3*params.mu*J2*params.Re^2/(2*r^4)*...
    (1 - 12*(h*sin(L) - k*cos(L))^2/ (1+ h^2 + k^2)^2); 
deltaJ2(2) = -12*params.mu*J2*params.Re^2/(r^4)*...
    (h*sin(L) - k*cos(L))*(h*cos(L) + k*sin(L))/(1+ h^2 + k^2)^2;
deltaJ2(3) = -6*params.mu*J2*params.Re^2/(r^4)*...
    (1 - h^2 - k^2)*(h*sin(L) - k*cos(L))/(1+ h^2 + k^2)^2;

deltaJ2_deltax = [0, 0, 0,                                                                                                                                    -(163821550772431*((24*sin(L)*(k*cos(L) - h*sin(L)))/(h^2 + k^2 + 1)^2 + (48*h*(k*cos(L) - h*sin(L))^2)/(h^2 + k^2 + 1)^3))/(8796093022208*r^4),                                                                                                                                     (163821550772431*((24*cos(L)*(k*cos(L) - h*sin(L)))/(h^2 + k^2 + 1)^2 - (48*k*(k*cos(L) - h*sin(L))^2)/(h^2 + k^2 + 1)^3))/(8796093022208*r^4),                                                              -(491464652317293*(h*cos(L) + k*sin(L))*(k*cos(L) - h*sin(L)))/(1099511627776*r^4*(h^2 + k^2 + 1)^2);
0, 0, 0, (163821550772431*cos(L)*(k*cos(L) - h*sin(L)))/(1099511627776*r^4*(h^2 + k^2 + 1)^2) - (163821550772431*sin(L)*(h*cos(L) + k*sin(L)))/(1099511627776*r^4*(h^2 + k^2 + 1)^2) - (163821550772431*h*(h*cos(L) + k*sin(L))*(k*cos(L) - h*sin(L)))/(274877906944*r^4*(h^2 + k^2 + 1)^3), (163821550772431*cos(L)*(h*cos(L) + k*sin(L)))/(1099511627776*r^4*(h^2 + k^2 + 1)^2) + (163821550772431*sin(L)*(k*cos(L) - h*sin(L)))/(1099511627776*r^4*(h^2 + k^2 + 1)^2) - (163821550772431*k*(h*cos(L) + k*sin(L))*(k*cos(L) - h*sin(L)))/(274877906944*r^4*(h^2 + k^2 + 1)^3), (163821550772431*(k*cos(L) - h*sin(L))^2)/(1099511627776*r^4*(h^2 + k^2 + 1)^2) - (163821550772431*(h*cos(L) + k*sin(L))^2)/(1099511627776*r^4*(h^2 + k^2 + 1)^2);
0, 0, 0,                  (163821550772431*sin(L)*(h^2 + k^2 - 1))/(2199023255552*r^4*(h^2 + k^2 + 1)^2) - (163821550772431*h*(k*cos(L) - h*sin(L)))/(1099511627776*r^4*(h^2 + k^2 + 1)^2) + (163821550772431*h*(k*cos(L) - h*sin(L))*(h^2 + k^2 - 1))/(549755813888*r^4*(h^2 + k^2 + 1)^3),                  (163821550772431*k*(k*cos(L) - h*sin(L))*(h^2 + k^2 - 1))/(549755813888*r^4*(h^2 + k^2 + 1)^3) - (163821550772431*k*(k*cos(L) - h*sin(L)))/(1099511627776*r^4*(h^2 + k^2 + 1)^2) - (163821550772431*cos(L)*(h^2 + k^2 - 1))/(2199023255552*r^4*(h^2 + k^2 + 1)^2),                                                                     (163821550772431*(h*cos(L) + k*sin(L))*(h^2 + k^2 - 1))/(2199023255552*r^4*(h^2 + k^2 + 1)^2)];
 
 
end